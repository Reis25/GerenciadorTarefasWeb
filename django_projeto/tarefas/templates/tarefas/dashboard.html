{% extends 'tarefas/base.html' %}

{% block title %}Dashboard - Gerenciador de Tarefas{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-chart-line"></i> Dashboard</h2>
    <div>
        <a href="{% url 'criar_tarefa' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Nova Tarefa
        </a>
    </div>
</div>

<!-- Estatísticas -->
<div class="row mb-4">
    <div class="col-md-3 mb-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title">Total de Tarefas</h6>
                        <h2 class="mb-0">{{ total_tarefas }}</h2>
                    </div>
                    <i class="fas fa-tasks fa-3x opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title">Concluídas</h6>
                        <h2 class="mb-0">{{ tarefas_concluidas }}</h2>
                    </div>
                    <i class="fas fa-check-circle fa-3x opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title">Pendentes</h6>
                        <h2 class="mb-0">{{ tarefas_pendentes }}</h2>
                    </div>
                    <i class="fas fa-clock fa-3x opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title">Projetos</h6>
                        <h2 class="mb-0">{{ total_projetos }}</h2>
                    </div>
                    <i class="fas fa-folder fa-3x opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Alertas -->
<div class="row mb-4">
    {% if tarefas_atrasadas > 0 %}
    <div class="col-md-4 mb-3">
        <div class="alert alert-danger">
            <i class="fas fa-exclamation-triangle"></i>
            <strong>{{ tarefas_atrasadas }}</strong> tarefa(s) atrasada(s)
        </div>
    </div>
    {% endif %}

    {% if tarefas_urgentes > 0 %}
    <div class="col-md-4 mb-3">
        <div class="alert alert-warning">
            <i class="fas fa-fire"></i>
            <strong>{{ tarefas_urgentes }}</strong> tarefa(s) urgente(s)
        </div>
    </div>
    {% endif %}

    {% if tarefas_alta > 0 %}
    <div class="col-md-4 mb-3">
        <div class="alert alert-info">
            <i class="fas fa-arrow-up"></i>
            <strong>{{ tarefas_alta }}</strong> tarefa(s) de alta prioridade
        </div>
    </div>
    {% endif %}
</div>

<!-- Conteúdo Principal -->
<div class="row">
    <!-- Tarefas Recentes -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-history"></i> Tarefas Recentes</h5>
            </div>
            <div class="card-body">
                {% if tarefas_recentes %}
                    <ul class="list-group list-group-flush">
                        {% for tarefa in tarefas_recentes %}
                        <li class="list-group-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <a href="{% url 'detalhes_tarefa' tarefa.pk %}" class="text-decoration-none">
                                        {{ tarefa.titulo }}
                                    </a>
                                    <br>
                                    <small class="text-muted">
                                        <span class="badge prioridade-{{ tarefa.prioridade }}">
                                            {{ tarefa.get_prioridade_display }}
                                        </span>
                                    </small>
                                </div>
                                {% if tarefa.concluida %}
                                    <i class="fas fa-check-circle text-success"></i>
                                {% else %}
                                    <i class="fas fa-circle text-warning"></i>
                                {% endif %}
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    <div class="card-footer bg-white text-center">
                        <a href="{% url 'lista_tarefas' %}" class="btn btn-sm btn-outline-primary">
                            Ver todas as tarefas
                        </a>
                    </div>
                {% else %}
                    <p class="text-muted text-center py-3">Nenhuma tarefa cadastrada</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Projetos -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-folder-open"></i> Projetos Ativos</h5>
            </div>
            <div class="card-body">
                {% if projetos %}
                    <ul class="list-group list-group-flush">
                        {% for projeto in projetos %}
                        <li class="list-group-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <a href="{% url 'detalhes_projeto' projeto.pk %}" class="text-decoration-none">
                                        <span class="badge" style="background-color: {{ projeto.cor }};">
                                            {{ projeto.nome }}
                                        </span>
                                    </a>
                                    <br>
                                    <small class="text-muted">
                                        {{ projeto.num_tarefas }} tarefa(s)
                                    </small>
                                </div>
                                <div class="text-end">
                                    <small class="text-muted">
                                        {{ projeto.tarefas_concluidas }} / {{ projeto.tarefas_pendentes }} concluídas
                                    </small>
                                </div>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    <div class="card-footer bg-white text-center">
                        <a href="{% url 'lista_projetos' %}" class="btn btn-sm btn-outline-primary">
                            Ver todos os projetos
                        </a>
                    </div>
                {% else %}
                    <p class="text-muted text-center py-3">Nenhum projeto cadastrado</p>
                    <div class="text-center">
                        <a href="{% url 'criar_projeto' %}" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Criar Primeiro Projeto
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
